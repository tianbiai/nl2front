# 前端 Agent 工作流程

## 📌 总体概述

根据用户需求自动生成页面设计文档和代码，进行移动端（uniapp）和 Web 端（Vue 3）的开发工作。

**⚠️ 重要：uniapp 项目统一使用 H5 模式进行开发和预览（强制要求）**

- **所有 uniapp 项目必须以 H5 模式生成**，确保可以在浏览器中正常访问
- **H5 模式是唯一开发和验证标准**：所有功能开发、测试、验证必须基于浏览器 H5 模式完成
- **开发和验证过程必须使用浏览器完成**，无需配置小程序开发环境
- 生成的项目通过 `npm run dev:h5` 启动，在浏览器中直接运行
- **禁止生成小程序相关配置和代码**，专注于 H5 模式开发
- **任何情况下都不应使用 `npm run dev:mp-weixin` 或其他小程序相关命令**
- **项目配置文件中必须确保 H5 相关配置正确**，包括路由模式、基础路径等
- **微信兼容代码通过条件编译处理**：如需支持微信小程序，仅通过 uniapp 条件编译语法（`#ifdef`、`#ifndef`）添加微信特定代码，不得影响 H5 主代码逻辑

## 🔴 核心原则

### 文档驱动开发（Document-Driven Development）

1. **spec.md 是项目唯一权威文档**

   - 各项目根目录 `projects/项目名/spec.md`：项目级完整功能说明书，使用 `rules/project-spec-template.md` 模板
   - 页面级 `spec.md`：基于项目根目录 spec.md 拆分，使用 `rules/spec-template.md` 模板
   - 严禁代码与文档不一致
2. **开发必须按顺序进行**

   - 先生成各项目根目录 `projects/项目名/spec.md` → 再进行开发 → 代码变更时同步更新文档
   - 严禁跳过 spec.md 直接编写代码
3. **需求变更管理**

   - 任何新增/调整需求必须先更新对应项目的根目录 spec.md（`projects/项目名/spec.md`），再更新页面级 spec.md
   - 严禁在不更新文档的情况下直接开发新功能

## 📚 适用的技能文档清单

在编写规格说明书时，已阅读并遵循以下技能文档：

### 核心 Vue 技能（必须阅读）

- [ ] `vue-best-practices/SKILL.md` ⭐⭐⭐ - Vue 3 核心最佳实践（响应式、组件、Props/Emits、模板、生命周期、插槽、过渡、TypeScript、性能等）
- [ ] `vue-development-guides/SKILL.md` ⭐⭐⭐ - Vue.js 开发核心原则（状态可预测、数据流明确、组件小型化）

### 状态管理与路由（按需阅读）

- [ ] `vue-pinia-best-practices/SKILL.md` - 使用 Pinia 状态管理时必读
- [ ] `vue-router-best-practices/SKILL.md` - 使用 Vue Router 时必读

### Composable 开发（按需阅读）

- [ ] `create-adaptable-composable/SKILL.md` - 创建可复用 Composable 时必读

### 前端设计与样式（必须阅读）

- [ ] `frontend-design/SKILL.md` ⭐⭐ - 前端界面设计规范（避免通用 AI 美学、创造独特的视觉风格）
- [ ] `brand-guidelines/SKILL.md` - 应用 Anthropic 官方品牌颜色和字体时参考
- [ ] `theme-factory/SKILL.md` - 使用 10 种预设主题样式时参考

### 其他技能（按需阅读）

- [ ] `vue-jsx-best-practices/SKILL.md` - 使用 JSX 语法时必读

---

## 🔄 工作流程总览

```
用户输入需求 → 需求分析与澄清 → 各项目根目录 spec.md（projects/项目名/spec.md） → MVP 框架开发验证 → 详细功能开发 → 项目验证 → 交付
```

---

## 📄 阶段零：需求分析与澄清

**核心原则**：主动沟通，充分理解，避免误解

### 需求确认清单

使用 `AskUserQuestion` 工具确认以下要素：

| 要素     | 说明              | 示例                                                             |
| -------- | ----------------- | ---------------------------------------------------------------- |
| 页面名称 | 页面唯一标识      | 用户登录页、商品列表页                                           |
| 核心目标 | 解决什么问题      | 用户通过手机号和验证码登录                                       |
| 目标平台 | 移动端/Web端/双端 | **移动端使用 uniapp H5 模式**（浏览器访问），Web端用 Vue 3 |
| 功能清单 | 包含哪些功能模块  | 登录表单、第三方登录、忘记密码                                   |
| 数据来源 | 数据从哪获取      | 用户输入、后端 API、本地存储                                     |
| 交互流程 | 用户操作路径      | 输入手机号 → 获取验证码 → 登录                                 |

### 🎨 设计要素确认（重点）

**⚠️ 重要**：前端页面的视觉效果直接影响用户体验，必须重点确认以下设计要素：

| 设计要素           | 说明                      | 示例                                           |
| ------------------ | ------------------------- | ---------------------------------------------- |
| **设计理念** | 整体设计思想和风格定位    | 极简主义、科技感、温暖亲和、专业商务           |
| **视觉风格** | 页面的整体视觉风格        | 现代简约、扁平化、Material Design、拟态风格    |
| **主色调**   | 品牌主色（Primary Color） | 科技蓝 #007AFF、活力橙 #FF6B00、清新绿 #00C853 |
| **辅助色**   | 辅助色彩配色方案          | 成功绿、警告黄、错误红、中性灰系列             |
| **布局方式** | 页面整体布局结构          | 左右分栏、上下布局、卡片式、瀑布流             |
| **参考案例** | 设计参考网站或应用        | Ant Design、Element Plus、Dribbble 作品        |

**💡 提示**：

- 如果用户没有明确的设计要求，可提供 2-3 种设计风格供选择
- 色彩选择应考虑品牌调性和用户群体特征
- 布局方式应适配目标设备的屏幕尺寸

### ⚠️ 常见误区

- ❌ 直接基于模糊需求开始开发
- ❌ 假设用户没有提到的功能就是不需要
- ❌ 仅凭猜测做出技术决策
- ✅ 主动提问澄清所有不确定点
- ✅ 确认边界条件和特殊情况
- ✅ 与用户确认对需求的理解是否准确

## 阶段一：生成完整项目功能说明书

**前置条件**：需求分析与澄清完成后

### 核心任务

按照 `rules/project-spec-template.md` 模板生成项目级 spec.md：

**文件路径**：`projects/项目名/spec.md`

### 技术栈选型

**⚠️ 重要：必须使用以下经过验证的稳定版本组合，严禁随意更改依赖版本！**

**移动端（uniapp）- H5 模式优先**：

- **开发原则**：遵循总体概述中的 H5 模式优先原则
- **核心框架**：@dcloudio/uni-app@3.0.0-4020920240930001（稳定版）
- **Vue 版本**：3.4.21
- **Vite 版本**：5.2.8
- **UI 组件库**：使用 uniapp 原生组件或 uni-ui（不使用 vant）
- **状态管理**：pinia@2.1.7 + pinia-plugin-persistedstate@3.2.1
- **运行命令**：`npm run dev:h5`
- **多端兼容**：如需支持微信小程序，仅通过条件编译语法（`#ifdef`、`#ifndef`）处理

**Web端（Vue 3）**：

- **Vue 版本**：3.4.21
- **Vue Router**：4.3.0
- **Pinia**：2.1.7
- **Element Plus**：2.6.1
- **Axios**：1.6.7
- **Vite**：5.2.0
- **Sass**：1.77.0

### 需求变更管理（持续性流程）

**适用场景**：项目开发过程中所有新增需求、功能调整、需求变更

### 变更流程

```
发现新需求 → 评估影响 → 更新对应项目的根目录 spec.md（projects/项目名/spec.md） → 获得确认 → 继续开发
```

### 变更规范

1. **第一时间更新对应项目的根目录 spec.md**

   - 新增页面 → 补充到"功能模块清单"和"页面设计规范"
   - 调整功能 → 更新对应的"交互流程"和"数据结构"
   - 变更设计 → 更新"全局视觉规范"
2. **变更影响评估**

   - 评估对现有功能的影响
   - 评估是否需要调整其他页面或组件
   - 评估技术方案是否需要调整
3. **确认后再开发**

   - 对应项目的根目录 spec.md 更新完成后需获得确认
   - 确认后方可进行代码开发

---

## 🏗️ 阶段二：MVP 开发与验证

**前置条件**：对应项目的 spec.md（projects/项目名/spec.md）已完成

### MVP 开发范围

**目标**：搭建项目基础架构，验证核心功能和技术方案的可行性

#### 核心架构搭建

1. **项目初始化**

   - **移动端**：创建 uniapp 项目（H5 模式优先，参见总体概述）
   - **Web 端**：创建 Vue 3 项目，配置基础目录结构
   - 安装必要的依赖包（vant4/element-plus、vue-router、axios、Pinia 等）
2. **基础配置**

   - 路由配置（vue-router）：定义基础路由结构
   - 状态管理（Pinia）：创建全局 store 结构
   - HTTP 请求封装：统一的 axios 实例和拦截器
   - 全局样式配置：定义 CSS 变量、通用样式
3. **核心组件开发**

   - 布局组件（Header、Footer、Sidebar 等）
   - 通用组件（Button、Form、Modal 等）
   - 业务组件（根据对应项目根目录 spec.md 的核心功能）
4. **核心功能实现**

   - 实现 1-2 个核心页面的完整流程
   - Mock 数据接口集成
   - 基础交互逻辑

#### MVP 开发原则

- **最小可行**：只实现核心功能，避免过度开发
- **快速验证**：优先验证技术方案可行性
- **迭代基础**：为后续功能开发奠定基础

### MVP 验证内容

1. 整体设计风格是否符合预期
2. 核心技术方案是否可行
3. 用户体验是否流畅
4. 是否需要调整对应项目的根目录 spec.md（projects/项目名/spec.md）

**⚠️ 验证通过后**：进入阶段三，基于对应项目的根目录 spec.md 进行详细功能开发。

## 📋 阶段三：详细功能开发

**前置条件**：

1. 对应项目的 spec.md（projects/项目名/spec.md）已完成
2. MVP 框架已确认
3. 整体设计风格已确认

### 开发规范

1. 基于对应项目的根目录 spec.md 中的整体原则和设计为每个页面创建页面级 spec.md
2. 页面级 spec.md 不得与对应项目的根目录 spec.md 冲突
3. 发现需要新增功能时，先更新对应项目 spec.md，再更新页面级spec.md
4. **uniapp 项目**：遵循 H5 优先原则（参见总体概述）

### API 接口管理规范

**重要说明**：当前阶段所有 API 接口均使用 Mock 数据方式提供，不进行实际的 HTTP 请求。

---

## ✅ 阶段四：完整项目验证

### 验证内容

1. 项目可编译且正常启动
2. 功能的完整验证
3. 整体项目的集成验证

### 验证流程

```
安装依赖 → 启动测试 → 浏览器验证 → 内容验证 → 验证通过
```

### 说明

- 验证所有功能正常运行
- 验证每个页面的功能按钮，确保均已经实现相应功能，没有"功能开发中"的占位代码
- 确保代码与需求文档一致
- **uniapp 项目验证**：使用 H5 模式进行验证（参见总体概述）

---

## 📋 工作流程总结

```
1️⃣ 需求分析
   ↓
2️⃣ 生成各项目根目录 spec.md（projects/项目名/spec.md）（项目级完整功能说明书）
   ↓
3️⃣ MVP 框架开发
   ↓
4️⃣ MVP 验证
   ↓
5️⃣ 详细功能开发
   ↓
6️⃣ 完整项目验证
   ↓
7️⃣ 交付成果
```

**核心原则回顾**：

- 各项目 spec.md（projects/项目名/spec.md）是唯一权威文档
- 所有开发工作必须基于对应项目 spec.md
- 需求变更必须先更新对应项目 spec.md
- 代码与文档保持一致
- **uniapp H5 优先原则**：所有 uniapp 项目必须以 H5 模式为主进行开发、验证和交付
- **条件编译规则**：微信等多端兼容仅通过条件编译实现，不得影响 H5 主代码

**项目结构说明**：

```
项目总目录/
├── projects/                        # 各项目目录
│   ├── 项目名/     		     # 移动端项目
│   │   ├── spec.md                  # 移动端项目级 spec.md
│   │   └── src/
│   │       └── pages/
│   │           └── login/
│   │               └── spec.md      # 页面级 spec.md
│   └── 项目名/      		     # Web端项目
│       ├── spec.md                  # Web端项目级 spec.md
│       └── src/
│           └── views/
│               └── dashboard/
│                   └── spec.md      # 页面级 spec.md
├── rules/                           # 通用模板
│   ├── project-spec-template.md     # 项目级 spec.md 模板
│   └── spec-template.md            # 页面级 spec.md 模板
├── skills/                          # 技能文档
└── CLAUDE.md                        # 本工作流程文档
```
